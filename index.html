<!DOCTYPE html>
<html>
  <head>

<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
<script type="text/javascript" src="//code.jquery.com/jquery-2.1.4.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.0/handlebars.min.js"></script>
<script type="text/javascript">
 var ws = new WebSocket('ws://localhost:8888/ws');
    var $message = $('#message');
    ws.onopen = function(){
      console.log("open");
    };
    ws.onmessage = function(ev){

      console.log("reci", ev);
      var data = JSON.parse(ev.data);
      if(data.status) {
        $(".progress").show();
        $(".progress-bar").width(data.status+ "%");
        $("span#msg").text(data.msg);
      } else {
        var html = template(ev.data);
        $("#message").html(html);
      }
    };
    ws.onclose = function(ev){
    };
    ws.onerror = function(ev){
      $("#message").text("problem with the socket");
    };

$(document).ready(function(){
  $("#analize").click(function(){
    var val = $("#url").val();
    console.log("send", val);
    ws.send(val);
  });
var source   = $("#result-template").html();
var template = Handlebars.compile(source);

});


</script>
</head>

<body>
<div class="container">
   <div class="row">
     <div class="col-md-4 col-md-offset-4">
    <div class="page-header">
      <h1 class="text-center">seolint</h1>
    </div>

      <div class="form-group">
        <input name="url" type="text" id="url" class="form-control" placeholder="url">
      </div>
      <br>
      <button id="analize" class="btn btn-default" >Analize</button>
      <br>

      <div class="progress" style="display:none;">
    
       <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">
        </div>
      </div>
        <span  id="msg"></span> 

      </div>
    </div>
    <div class="row">
      <div class="col-md-8">
          <div id="message"></div>
       </div>
    </div>
</div>
<script  id="result-template" type="text/x-handlebars-template">
{{!#each tags}}
{{!keywords.tag}} {{!keywords.count}} {{!keywords.kw}}
{{!/each}}
  
</script>

</body>
</html>
